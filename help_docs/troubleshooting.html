<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X·ª≠ l√Ω s·ª± c·ªë th∆∞·ªùng g·∫∑p</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="breadcrumb">
            <a href="index.html">Trang ch·ªß</a> &gt; X·ª≠ l√Ω s·ª± c·ªë th∆∞·ªùng g·∫∑p
        </div>

        <h1>‚ö†Ô∏è X·ª≠ l√Ω s·ª± c·ªë th∆∞·ªùng g·∫∑p</h1>

        <div class="section">
            <h2>S·ª± c·ªë x√°c th·ª±c (Authentication)</h2>
            
            <div class="problem-box">
                <h3>üî¥ Kh√¥ng ƒëƒÉng nh·∫≠p ƒë∆∞·ª£c</h3>
                
                <div class="solution">
                    <p><strong>Tri·ªáu ch·ª©ng:</strong> Nh·∫≠p username/password nh∆∞ng b√°o l·ªói 401</p>
                    <p><strong>Nguy√™n nh√¢n:</strong></p>
                    <ul>
                        <li>Username ho·∫∑c password sai</li>
                        <li>Ph√¢n bi·ªát ch·ªØ hoa/th∆∞·ªùng</li>
                        <li>T√†i kho·∫£n b·ªã kh√≥a</li>
                    </ul>
                    <p><strong>Gi·∫£i ph√°p:</strong></p>
                    <ol>
                        <li>Ki·ªÉm tra k·ªπ username v√† password</li>
                        <li>ƒê·∫£m b·∫£o kh√¥ng c√≥ kho·∫£ng tr·∫Øng th·ª´a</li>
                        <li>Th·ª≠ ƒëƒÉng k√Ω t√†i kho·∫£n m·ªõi n·∫øu qu√™n m·∫≠t kh·∫©u</li>
                        <li>Li√™n h·ªá th∆∞ vi·ªán n·∫øu t√†i kho·∫£n b·ªã kh√≥a</li>
                    </ol>
                </div>
            </div>

            <div class="problem-box">
                <h3>üî¥ Token h·∫øt h·∫°n</h3>
                
                <div class="solution">
                    <p><strong>Tri·ªáu ch·ª©ng:</strong> B√°o l·ªói "Token expired" ho·∫∑c 401 khi g·ªçi API</p>
                    <p><strong>Nguy√™n nh√¢n:</strong> Token c√≥ th·ªùi h·∫°n 24 gi·ªù</p>
                    <p><strong>Gi·∫£i ph√°p:</strong></p>
                    <ol>
                        <li>ƒêƒÉng nh·∫≠p l·∫°i ƒë·ªÉ l·∫•y token m·ªõi</li>
                        <li>L∆∞u token m·ªõi v√†o localStorage</li>
                        <li>S·ª≠ d·ª•ng token m·ªõi cho c√°c request ti·∫øp theo</li>
                    </ol>
                    <div class="code-block">
                        <pre>// X·ª≠ l√Ω token h·∫øt h·∫°n t·ª± ƒë·ªông
fetch(url, {
  headers: { 'Authorization': `Bearer ${token}` }
})
.then(response => {
  if (response.status === 401) {
    // Token h·∫øt h·∫°n, chuy·ªÉn ƒë·∫øn trang login
    window.location.href = '/login';
  }
  return response.json();
});</pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>S·ª± c·ªë v·ªÅ th√¥ng tin c√° nh√¢n</h2>
            
            <div class="problem-box">
                <h3>üî¥ Kh√¥ng xem ƒë∆∞·ª£c th√¥ng tin</h3>
                
                <div class="solution">
                    <p><strong>Tri·ªáu ch·ª©ng:</strong> API tr·∫£ v·ªÅ 403 Forbidden</p>
                    <p><strong>Nguy√™n nh√¢n:</strong> ƒêang c·ªë xem th√¥ng tin c·ªßa ng∆∞·ªùi kh√°c</p>
                    <p><strong>Gi·∫£i ph√°p:</strong></p>
                    <ul>
                        <li>Ki·ªÉm tra ID trong URL c√≥ kh·ªõp v·ªõi ID c·ªßa b·∫°n kh√¥ng</li>
                        <li>ID c·ªßa b·∫°n ƒë∆∞·ª£c tr·∫£ v·ªÅ khi ƒëƒÉng nh·∫≠p (tr∆∞·ªùng user.id)</li>
                        <li>Ch·ªâ s·ª≠ d·ª•ng ID c·ªßa ch√≠nh m√¨nh</li>
                    </ul>
                    <div class="code-block">
                        <pre>// L·∫•y ID t·ª´ response ƒëƒÉng nh·∫≠p
const loginResponse = {
  "user": {
    "id": 5,  // ‚Üê ƒê√¢y l√† ID c·ªßa b·∫°n
    "username": "reader123"
  }
};

// S·ª≠ d·ª•ng ƒë√∫ng ID
GET /api/readers/5  // ‚úì ƒê√∫ng
GET /api/readers/3  // ‚úó Sai (ID c·ªßa ng∆∞·ªùi kh√°c)</pre>
                    </div>
                </div>
            </div>

            <div class="problem-box">
                <h3>üî¥ Kh√¥ng c·∫≠p nh·∫≠t ƒë∆∞·ª£c email</h3>
                
                <div class="solution">
                    <p><strong>Tri·ªáu ch·ª©ng:</strong> API tr·∫£ v·ªÅ 409 Conflict</p>
                    <p><strong>Nguy√™n nh√¢n:</strong> Email m·ªõi ƒë√£ ƒë∆∞·ª£c ng∆∞·ªùi kh√°c s·ª≠ d·ª•ng</p>
                    <p><strong>Gi·∫£i ph√°p:</strong></p>
                    <ul>
                        <li>Ch·ªçn email kh√°c ch∆∞a ƒë∆∞·ª£c ƒëƒÉng k√Ω</li>
                        <li>Ki·ªÉm tra ch√≠nh t·∫£ email</li>
                        <li>S·ª≠ d·ª•ng email c√° nh√¢n ri√™ng</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>S·ª± c·ªë v·ªÅ th·∫ª th∆∞ vi·ªán</h2>
            
            <div class="problem-box">
                <h3>üî¥ Th·∫ª h·∫øt h·∫°n kh√¥ng m∆∞·ª£n ƒë∆∞·ª£c s√°ch</h3>
                
                <div class="solution">
                    <p><strong>Tri·ªáu ch·ª©ng:</strong> Kh√¥ng t·∫°o ƒë∆∞·ª£c y√™u c·∫ßu m∆∞·ª£n s√°ch</p>
                    <p><strong>Nguy√™n nh√¢n:</strong> Th·∫ª th∆∞ vi·ªán ƒë√£ h·∫øt h·∫°n</p>
                    <p><strong>Gi·∫£i ph√°p:</strong></p>
                    <ol>
                        <li>Ki·ªÉm tra tr·∫°ng th√°i th·∫ª: GET /api/readers/:id/card-info</li>
                        <li>N·∫øu h·∫øt h·∫°n, li√™n h·ªá th∆∞ vi·ªán ƒë·ªÉ gia h·∫°n</li>
                        <li>Sau khi gia h·∫°n, th·ª≠ l·∫°i</li>
                    </ol>
                    <p><strong>Xem chi ti·∫øt:</strong> <a href="card_renewal.html">H∆∞·ªõng d·∫´n gia h·∫°n th·∫ª</a></p>
                </div>
            </div>

            <div class="problem-box">
                <h3>üî¥ Kh√¥ng bi·∫øt khi n√†o th·∫ª h·∫øt h·∫°n</h3>
                
                <div class="solution">
                    <p><strong>Gi·∫£i ph√°p:</strong></p>
                    <ol>
                        <li>G·ªçi API: GET /api/readers/:id/card-info</li>
                        <li>Xem tr∆∞·ªùng expiry_date v√† days_remaining</li>
                        <li>N·∫øu days_remaining &lt; 30, n√™n gia h·∫°n s·ªõm</li>
                    </ol>
                    <div class="code-block">
                        <pre>// Ki·ªÉm tra t·ª± ƒë·ªông
function alertIfExpiring(cardInfo) {
  if (cardInfo.days_remaining < 7) {
    alert('‚ö†Ô∏è KH·∫®N C·∫§P: Th·∫ª c√≤n ' + cardInfo.days_remaining + ' ng√†y!');
  } else if (cardInfo.days_remaining < 30) {
    console.warn('Th·∫ª c√≤n ' + cardInfo.days_remaining + ' ng√†y');
  }
}</pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>S·ª± c·ªë k·∫øt n·ªëi API</h2>
            
            <div class="problem-box">
                <h3>üî¥ L·ªói CORS (Cross-Origin)</h3>
                
                <div class="solution">
                    <p><strong>Tri·ªáu ch·ª©ng:</strong> Console b√°o "CORS policy blocked"</p>
                    <p><strong>Nguy√™n nh√¢n:</strong> Frontend v√† Backend kh√°c domain</p>
                    <p><strong>Gi·∫£i ph√°p t·∫°m th·ªùi:</strong></p>
                    <ul>
                        <li>S·ª≠ d·ª•ng proxy trong development</li>
                        <li>Ho·∫∑c c√†i extension CORS Unblock cho Chrome</li>
                    </ul>
                    <p><strong>Gi·∫£i ph√°p l√¢u d√†i:</strong> Y√™u c·∫ßu admin backend c·∫•u h√¨nh CORS</p>
                </div>
            </div>

            <div class="problem-box">
                <h3>üî¥ L·ªói Network/Timeout</h3>
                
                <div class="solution">
                    <p><strong>Tri·ªáu ch·ª©ng:</strong> Request kh√¥ng c√≥ response ho·∫∑c timeout</p>
                    <p><strong>Nguy√™n nh√¢n:</strong></p>
                    <ul>
                        <li>Server kh√¥ng ch·∫°y</li>
                        <li>URL sai</li>
                        <li>Firewall ch·∫∑n</li>
                    </ul>
                    <p><strong>Gi·∫£i ph√°p:</strong></p>
                    <ol>
                        <li>Ki·ªÉm tra server c√≥ ƒëang ch·∫°y: http://localhost:5000</li>
                        <li>Ki·ªÉm tra URL ƒë√∫ng ch∆∞a (port, path)</li>
                        <li>Th·ª≠ ping ho·∫∑c curl ƒë·ªÉ test k·∫øt n·ªëi</li>
                    </ol>
                </div>
            </div>

            <div class="problem-box">
                <h3>üî¥ L·ªói 500 Internal Server Error</h3>
                
                <div class="solution">
                    <p><strong>Tri·ªáu ch·ª©ng:</strong> API tr·∫£ v·ªÅ l·ªói 500</p>
                    <p><strong>Nguy√™n nh√¢n:</strong> L·ªói t·ª´ ph√≠a server</p>
                    <p><strong>Gi·∫£i ph√°p:</strong></p>
                    <ul>
                        <li>Ki·ªÉm tra request body c√≥ ƒë√∫ng format kh√¥ng</li>
                        <li>Xem console log c·ªßa server ƒë·ªÉ bi·∫øt l·ªói c·ª• th·ªÉ</li>
                        <li>Li√™n h·ªá admin n·∫øu l·ªói l·∫∑p l·∫°i</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Checklist debug</h2>
            
            <div class="checklist-box">
                <h3>‚úÖ Khi g·∫∑p l·ªói, ki·ªÉm tra theo th·ª© t·ª±:</h3>
                <ol>
                    <li>
                        <input type="checkbox"> Server c√≥ ƒëang ch·∫°y kh√¥ng?
                        <div class="code-block">
                            <pre>// Test
curl http://localhost:5000
// Ho·∫∑c m·ªü browser: http://localhost:5000</pre>
                        </div>
                    </li>
                    <li>
                        <input type="checkbox"> URL c√≥ ƒë√∫ng kh√¥ng? (port, endpoint, ID)
                        <div class="code-block">
                            <pre>// ƒê√∫ng
http://localhost:5000/api/readers/5

// Sai
http://localhost:3000/api/readers/5  // ‚úó Port sai
http://localhost:5000/readers/5      // ‚úó Thi·∫øu /api
http://localhost:5000/api/reader/5   // ‚úó reader thay v√¨ readers</pre>
                        </div>
                    </li>
                    <li>
                        <input type="checkbox"> Header c√≥ token ch∆∞a?
                        <div class="code-block">
                            <pre>// Ki·ªÉm tra trong code
console.log('Token:', token);

// Header ph·∫£i c√≥
Authorization: Bearer eyJhbGciOiJI...</pre>
                        </div>
                    </li>
                    <li>
                        <input type="checkbox"> Token c√≤n h·∫°n kh√¥ng?
                        <div class="code-block">
                            <pre>// N·∫øu g·∫∑p l·ªói 401, th·ª≠ login l·∫°i
POST /api/auth/login</pre>
                        </div>
                    </li>
                    <li>
                        <input type="checkbox"> Request body ƒë√∫ng format kh√¥ng?
                        <div class="code-block">
                            <pre>// Ph·∫£i l√† JSON h·ª£p l·ªá
{
  "email": "test@example.com"  // ‚úì ƒê√∫ng
}

{
  email: "test@example.com"    // ‚úó Sai (thi·∫øu d·∫•u ngo·∫∑c k√©p)
}</pre>
                        </div>
                    </li>
                    <li>
                        <input type="checkbox"> Xem console log c√≥ l·ªói g√¨ kh√¥ng?
                    </li>
                    <li>
                        <input type="checkbox"> Xem Network tab trong DevTools
                    </li>
                </ol>
            </div>
        </div>

        <div class="section">
            <h2>Tools h·ªØu √≠ch ƒë·ªÉ debug</h2>
            
            <div class="tools-box">
                <h3>1. Browser DevTools</h3>
                <p>M·ªü b·∫±ng F12, xem tab:</p>
                <ul>
                    <li><strong>Console:</strong> Xem l·ªói JavaScript</li>
                    <li><strong>Network:</strong> Xem request/response</li>
                    <li><strong>Application:</strong> Xem localStorage, token</li>
                </ul>

                <h3>2. Postman / Insomnia</h3>
                <p>Tools chuy√™n d·ª•ng ƒë·ªÉ test API:</p>
                <ul>
                    <li>D·ªÖ d√†ng th√™m header, body</li>
                    <li>L∆∞u collection API</li>
                    <li>Xem response r√µ r√†ng</li>
                </ul>

                <h3>3. cURL (Command line)</h3>
                <div class="code-block">
                    <pre># Test ƒëƒÉng nh·∫≠p
curl -X POST http://localhost:5000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"reader123","password":"123456"}'

# Test API v·ªõi token
curl -X GET http://localhost:5000/api/readers/5 \
  -H "Authorization: Bearer YOUR_TOKEN"</pre>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Li√™n h·ªá h·ªó tr·ª£</h2>
            
            <div class="contact-box">
                <p>N·∫øu v·∫´n kh√¥ng gi·∫£i quy·∫øt ƒë∆∞·ª£c, li√™n h·ªá:</p>
                <ul>
                    <li>üìß <strong>Email:</strong> support@ute.edu.vn</li>
                    <li>üìû <strong>ƒêi·ªán tho·∫°i:</strong> (028) 3896 5757</li>
                    <li>üè¢ <strong>ƒê·ªãa ch·ªâ:</strong> Th∆∞ vi·ªán UTE, gi·ªù h√†nh ch√≠nh</li>
                </ul>
                
                <p><strong>Khi li√™n h·ªá, cung c·∫•p:</strong></p>
                <ol>
                    <li>M√¥ t·∫£ chi ti·∫øt l·ªói</li>
                    <li>Screenshot (n·∫øu c√≥)</li>
                    <li>Status code (401, 403, 500...)</li>
                    <li>URL b·∫°n ƒëang g·ªçi</li>
                    <li>Request body (n·∫øu c√≥)</li>
                </ol>
            </div>
        </div>

        <div class="navigation">
            <a href="card_info.html" class="btn">‚Üê Xem th√¥ng tin th·∫ª</a>
            <a href="api_reference.html" class="btn">T√†i li·ªáu API ‚Üí</a>
        </div>
    </div>
</body>
</html>


